<div class="row">
  <div class="col-md-2"></div>
  <div class="col-md-8">

    <div class="article">
      <div class="article-header">
        <h3 class="color-darkblue">Trend Line for Total Market Transactions</h3>
      </div>
      <div class="article-body">
        <canvas id="abbotsford_total_canvas"></canvas>
      </div>
    </div>

    <div class="article">
      <div class="article-header">
        <h3 class="color-darkblue">Property Types</h3>
      </div>
      <div class="article-body">
        <canvas id="abbotsford_type_canvas"></canvas>
      </div>
    </div>

  </div>
  <div class="col-md-2"></div>
</div>



<script>
$(document).ready(function() {

  // stacked bar options
  var options_stack = {
    responsive: true,
    scales: {
      xAxes: [{
        stacked: true
      }],
      yAxes: [{
        stacked: true
      }]
    },
    tooltips: {
      callbacks: {
        label: function(tooltipItem, data) {
          var dataset = data.datasets[tooltipItem.datasetIndex];
          var total = data.datasets[5].data[tooltipItem.index];

          var currentValue = dataset.data[tooltipItem.index];         
          var precentage = Math.floor( ((currentValue/total) * 100) + 0.5 );
          return currentValue + " (" + precentage + "%)";
        }
      }
    }
  };


  // data

  var months = ["June 01", "July 01", "Aug 01", "Sep 01", "Oct 01", "Nov 01", "Dec 01"];
  
  var abbotsford_total = [643,552,509,401,354,354,286];
  var abbotsford_resid_trans = [635,541,494,387,348,347,272];
  var abbotsford_comm_tot = [7,9,9,10,2,5,8];
  var abbotsford_recr_tot = [0,0,0,1,1,0,0];
  var abbotsford_farm_tot = [1,2,3,3,2,2,4];
  var abbotsford_unkn_tot = [0,0,3,0,1,0,2];


  var abbotsford_total_data = {
    labels: months,
    datasets: [
      {
        label: "Total Market Transactions",
        data: abbotsford_total,
        fill: false,
        backgroundColor: 'rgba(75,192,192, 0.7)',
        borderColor: 'rgba(75,192,192, 1)',
        borderWidth: 5,
        borderJoinStyle: 'round',
        lineTension: 0.1
      }
    ]
  };


  var abbotsford_type_data = {
    labels: months,
    datasets: [{
      type: 'bar',
      label: 'Residential',
      data: abbotsford_resid_trans,
      backgroundColor: 'rgba(80, 244, 66, 0.7)',
      borderColor: 'rgba(80, 244, 66, 1)',
      
    }, {
      type: 'bar',
      label: 'Commercial',
      data: abbotsford_comm_tot,
      backgroundColor: 'rgba(66, 244, 206, 0.7)',
      borderColor: 'rgba(66, 244, 206, 1)',
      
    }, {
      type: 'bar',
      label: 'Recreational',
      data: abbotsford_recr_tot,
      backgroundColor: 'rgba(153, 102, 255, 0.7)',
      borderColor: 'rgba(153, 102, 255, 1)',
      
    }, {
      type: 'bar',
      label: 'Farm',
      data: abbotsford_farm_tot,
      backgroundColor: 'rgba(244, 232, 66, 0.7)',
      borderColor: 'rgba(244, 232, 66, 1)',
      
    }, {
      type: 'bar',
      label: 'Unknown',
      data: abbotsford_unkn_tot,
      backgroundColor: 'rgba(255, 159, 64, 0.7)',
      borderColor: 'rgba(255, 159, 64, 1)',
      
    }, {
      type: 'line',
      label: "Total Market Transactions",
      data: abbotsford_total,
      fill: false,
      backgroundColor: 'rgba(75,192,192, 0.7)',
      borderColor: 'rgba(75,192,192, 1)',
      borderWidth: 3,
      borderJoinStyle: 'round',
      lineTension: 0.1
    }]
  };



  // canvas display

  var abbotsford_total_canvas = new Chart($("#abbotsford_total_canvas"), {
    type: 'line',
    data: abbotsford_total_data
  });

  //var abbotsford_type_canvas = document.getElementById("abbotsford_type_canvas").getContext("2d");
  //abbotsford_type_canvas.canvas.width = 500;
  //abbotsford_type_canvas.canvas.height = 300;
  var abbotsford_type_chart = new Chart($("#abbotsford_type_canvas"), {
    type: "bar",
    data: abbotsford_type_data,
    options: options_stack
  });


});
</script>